%the finite difference form of Reynolds equation, function 5

function output=reynolds(q,r,P,H,R,dhdq,dhdr,bn,i,j)

    h=H(i,j);
    output=4*r^2*P(i,j)*h^3*P(i+1,j)/R^2+4*r^2*h^3*P(i,j)*P(i-1,j)/R^2-8*r^2*h^3*P(i,j)^2/R^2+4*q^2*h^3*P(i,j)*P(i,j+1)...
     +4*q^2*h^3*P(i,j)*P(i,j-1) -8*q^2*h^3*P(i,j)^2+r^2*h^3*P(i+1,j)^2/R^2 +r^2*h^3*P(i-1,j)^2/R^2 ...
     -2*r^2*h^3*P(i-1,j)*P(i+1,j)/R^2+6*q*r^2*h^2*dhdq*P(i,j)*P(i+1,j)/R^2-6*r^2*q*dhdq*h^2*P(i,j)*P(i-1,j)/R^2 ...
     +h^3*q^2*P(i,j+1)^2-2*q^2*h^3*P(i,j+1)*P(i,j-1) +q^2*h^3*P(i,j-1)^2+6*q^2*r*dhdr*h^2*P(i,j)*P(i,j+1) ...
     -6*q^2*r*dhdr*h^2*P(i,j)*P(i,j-1)+2*q^2*r*h^3*P(i,j)*P(i,j+1)/R-2*q^2*r*h^3*P(i,j)*P(i,j-1)/R...
     -2*q*r^2*bn*h*P(i+1,j)+2*q*r^2*bn*h*P(i-1,j)-4*r^2*q^2*bn*dhdq*P(i,j);
end